<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>API Frontend ‚Äî –ë–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
    h2 { margin-top: 30px; border-bottom: 1px solid #ccc; padding-bottom: 5px; }
    .endpoint { background: #f9f9f9; padding: 15px; margin: 10px 0; border-radius: 4px; }
    input, button, select { padding: 6px; margin: 4px; }
    pre { background: #eee; padding: 10px; border-radius: 4px; overflow-x: auto; }
    .response { margin-top: 8px; min-height: 24px; }
  </style>
</head>
<body>
  <h1>Frontend –¥–ª—è FastAPI </h1>
  <p>—Ç–æ–ª—å–∫–æ –≤ –±—ç–∫–µ–Ω–¥.</p>

  <!-- USERS -->
  <h2>üë§ Users</h2>

  <div class="endpoint">
    <h3>GET /users</h3>
    <button onclick="fetchData('/users', 'GET', null, 'users-list')">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
    <div class="response" id="users-list"></div>
  </div>

  <div class="endpoint">
    <h3>POST /users</h3>
    <input placeholder="email" id="user-email" />
    <input placeholder="name" id="user-name" />
    <input placeholder="password" id="user-password" />
    <button onclick="postData('/users', {email: getValue('user-email'), name: getValue('user-name'), password: getValue('user-password')}, 'users-create')">–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
    <div class="response" id="users-create"></div>
  </div>

  <div class="endpoint">
    <h3>GET /users/{id}</h3>
    <input placeholder="ID" id="user-get-id" style="width:80px" />
    <button onclick="fetchData('/users/' + getValue('user-get-id'), 'GET', null, 'user-get')">–ü–æ–ª—É—á–∏—Ç—å –ø–æ ID</button>
    <div class="response" id="user-get"></div>
  </div>

  <div class="endpoint">
    <h3>PUT /users/{id}</h3>
    <input placeholder="ID" id="user-update-id" style="width:80px" />
    <input placeholder="email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" id="user-update-email" />
    <input placeholder="name (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" id="user-update-name" />
    <input placeholder="password (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" id="user-update-password" />
    <button onclick="updateUser()">–û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
    <div class="response" id="user-update"></div>
  </div>

  <div class="endpoint">
    <h3>DELETE /users/{id}</h3>
    <input placeholder="ID" id="user-delete-id" style="width:80px" />
    <button onclick="fetchData('/users/' + getValue('user-delete-id'), 'DELETE', null, 'user-delete')">–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
    <div class="response" id="user-delete"></div>
  </div>

  <!-- CLIENTS -->
  <h2>üë§ Clients</h2>

  <div class="endpoint">
    <h3>GET /clients</h3>
    <button onclick="fetchData('/clients', 'GET', null, 'clients-list')">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</button>
    <div class="response" id="clients-list"></div>
  </div>

  <div class="endpoint">
    <h3>POST /clients</h3>
    <input placeholder="name" id="client-name" />
    <input placeholder="phone" id="client-phone" />
    <input placeholder="email" id="client-email" />
    <button onclick="postData('/clients', {name: getValue('client-name'), phone: getValue('client-phone'), email: getValue('client-email')}, 'clients-create')">–°–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</button>
    <div class="response" id="clients-create"></div>
  </div>

  <div class="endpoint">
    <h3>GET /clients/{id}</h3>
    <input placeholder="ID" id="client-get-id" style="width:80px" />
    <button onclick="fetchData('/clients/' + getValue('client-get-id'), 'GET', null, 'client-get')">–ü–æ–ª—É—á–∏—Ç—å –ø–æ ID</button>
    <div class="response" id="client-get"></div>
  </div>

  <div class="endpoint">
    <h3>PUT /clients/{id}</h3>
    <input placeholder="ID" id="client-update-id" style="width:80px" />
    <input placeholder="name (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" id="client-update-name" />
    <input placeholder="phone (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" id="client-update-phone" />
    <input placeholder="email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" id="client-update-email" />
    <button onclick="updateClient()">–û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</button>
    <div class="response" id="client-update"></div>
  </div>

  <div class="endpoint">
    <h3>DELETE /clients/{id}</h3>
    <input placeholder="ID" id="client-delete-id" style="width:80px" />
    <button onclick="fetchData('/clients/' + getValue('client-delete-id'), 'DELETE', null, 'client-delete')">–£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</button>
    <div class="response" id="client-delete"></div>
  </div>

  <!-- DEALS -->
  <h2>üíº Deals</h2>

  <div class="endpoint">
    <h3>GET /deals</h3>
    <button onclick="fetchData('/deals', 'GET', null, 'deals-list')">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–¥–µ–ª–∫–∏</button>
    <div class="response" id="deals-list"></div>
  </div>

  <div class="endpoint">
    <h3>POST /deals</h3>
    <input placeholder="title" id="deal-title" />
    <input placeholder="amount (—á–∏—Å–ª–æ)" id="deal-amount" />
    <input placeholder="status" id="deal-status" />
    <input placeholder="client_id (—á–∏—Å–ª–æ)" id="deal-client-id" />
    <button onclick="postData('/deals', {title: getValue('deal-title'), amount: parseInt(getValue('deal-amount')), status: getValue('deal-status'), client_id: parseInt(getValue('deal-client-id'))}, 'deals-create')">–°–æ–∑–¥–∞—Ç—å —Å–¥–µ–ª–∫—É</button>
    <div class="response" id="deals-create"></div>
  </div>

  <div class="endpoint">
    <h3>GET /deals/{id}</h3>
    <input placeholder="ID" id="deal-get-id" style="width:80px" />
    <button onclick="fetchData('/deals/' + getValue('deal-get-id'), 'GET', null, 'deal-get')">–ü–æ–ª—É—á–∏—Ç—å –ø–æ ID</button>
    <div class="response" id="deal-get"></div>
  </div>

  <div class="endpoint">
    <h3>PUT /deals/{id}</h3>
    <input placeholder="ID" id="deal-update-id" style="width:80px" />
    <input placeholder="title (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" id="deal-update-title" />
    <input placeholder="amount (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —á–∏—Å–ª–æ)" id="deal-update-amount" />
    <input placeholder="status (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" id="deal-update-status" />
    <input placeholder="client_id (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —á–∏—Å–ª–æ)" id="deal-update-client-id" />
    <button onclick="updateDeal()">–û–±–Ω–æ–≤–∏—Ç—å —Å–¥–µ–ª–∫—É</button>
    <div class="response" id="deal-update"></div>
  </div>

  <div class="endpoint">
    <h3>DELETE /deals/{id}</h3>
    <input placeholder="ID" id="deal-delete-id" style="width:80px" />
    <button onclick="fetchData('/deals/' + getValue('deal-delete-id'), 'DELETE', null, 'deal-delete')">–£–¥–∞–ª–∏—Ç—å —Å–¥–µ–ª–∫—É</button>
    <div class="response" id="deal-delete"></div>
  </div>

  <script>
    const API_BASE = 'http://127.0.0.1:8000'; // –ø–æ–ª–Ω—ã–π URL –¥–ª—è API

    function getValue(id) {
      return document.getElementById(id).value.trim();
    }

    function showResponse(elementId, data, isError = false) {
      const el = document.getElementById(elementId);
      el.innerHTML = `<pre style="color:${isError ? 'red' : 'black'}">${JSON.stringify(data, null, 2)}</pre>`;
    }

    async function fetchData(url, method, body, elementId) {
      try {
        const opts = { method };
        if (body) {
          opts.headers = { 'Content-Type': 'application/json' };
          opts.body = JSON.stringify(body);
        }
        const res = await fetch(API_BASE + url, opts);
        const data = await res.json();
        showResponse(elementId, data);
      } catch (err) {
        showResponse(elementId, { error: err.message }, true);
      }
    }

    function postData(url, data, elementId) {
      fetchData(url, 'POST', data, elementId);
    }

    function updateUser() {
      const id = getValue('user-update-id');
      const updateData = {};
      if (getValue('user-update-email')) updateData.email = getValue('user-update-email');
      if (getValue('user-update-name')) updateData.name = getValue('user-update-name');
      if (getValue('user-update-password')) updateData.password = getValue('user-update-password');
      fetchData(`/users/${id}`, 'PUT', updateData, 'user-update');
    }

    function updateClient() {
      const id = getValue('client-update-id');
      const updateData = {};
      if (getValue('client-update-name')) updateData.name = getValue('client-update-name');
      if (getValue('client-update-phone')) updateData.phone = getValue('client-update-phone');
      if (getValue('client-update-email')) updateData.email = getValue('client-update-email');
      fetchData(`/clients/${id}`, 'PUT', updateData, 'client-update');
    }

    function updateDeal() {
      const id = getValue('deal-update-id');
      const updateData = {};
      if (getValue('deal-update-title')) updateData.title = getValue('deal-update-title');
      if (getValue('deal-update-amount')) updateData.amount = parseInt(getValue('deal-update-amount'));
      if (getValue('deal-update-status')) updateData.status = getValue('deal-update-status');
      if (getValue('deal-update-client-id')) updateData.client_id = parseInt(getValue('deal-update-client-id'));
      fetchData(`/deals/${id}`, 'PUT', updateData, 'deal-update');
    }
  </script>
</body>
</html>